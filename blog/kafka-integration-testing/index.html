<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.5.0"/><meta data-react-helmet="true" name="description" content="Use Testcontainers to test Kafka messaging."/><meta data-react-helmet="true" name="keywords" content="testingboss, testing, boss, test, automation, software, development, coding,automation,testcontainers,kafka,integration,async,docker,container"/><meta data-react-helmet="true" property="og:url" content="https://testingboss.com /blog/kafka-integration-testing/"/><meta data-react-helmet="true" property="og:title" content="Kafka Integration Testing with Testcontainers"/><meta data-react-helmet="true" property="og:description" content="Use Testcontainers to test Kafka messaging."/><meta data-react-helmet="true" property="og:image" content="https://testingboss.com/static/f0319c86b2f76e33de4adb79f3866b19/4d227/data-streams.jpg"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:site" content="@kwo_ding"/><meta data-react-helmet="true" name="twitter:creator" content="@kwo_ding"/><meta data-react-helmet="true" name="twitter:title" content="Kafka Integration Testing with Testcontainers"/><meta data-react-helmet="true" name="twitter:description" content="Use Testcontainers to test Kafka messaging."/><meta data-react-helmet="true" name="twitter:image" content="https://testingboss.com/static/f0319c86b2f76e33de4adb79f3866b19/4d227/data-streams.jpg"/><meta data-react-helmet="true" name="twitter:image:alt" content="Kafka Integration Testing with Testcontainers"/><style data-href="/styles.6bda3da9855d00866448.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}body,html{background-color:#fff;color:#222;font-family:Poppins,serif;font-size:1em;line-height:1.5em;margin:0;padding:0}main{padding:20px}h1{color:#ff5e1a;font-family:Poppins,sans-serif;font-size:2em;line-height:1.125em;margin:0}h2{font-size:1.3em}h2,h3{color:#ff5e1a;font-family:Poppins,sans-serif;margin:1em 0}h3{font-size:1.2em}h4{font-size:1.1em}h4,h5{color:#ff5e1a;font-family:Poppins,sans-serif;margin:1em 0}h5{font-size:1em}table{border-collapse:collapse;font-size:.8em;margin:25px 0;min-width:400px}table thead tr{background-color:#ff5e1a;color:#fff;text-align:left}table tbody tr{border-bottom:1px solid #ddd}table tbody tr:nth-of-type(2n){background-color:#f3f3f3}table tbody tr:last-of-type{border-bottom:2px solid #ff5e1a}table td,table th{padding:10px;vertical-align:top}.gatsby-highlight pre[class*=language-],code.language-text{font-size:.8em}.header-module--site-header--e2980{box-sizing:border-box;font-family:Poppins,sans-serif;margin:0;padding:0}.header-module--site-header--e2980 nav{background:#ff5e1a;padding:0 1em}.header-module--site-header--e2980 a:active,.header-module--site-header--e2980 a:hover,.header-module--site-header--e2980 a:link,.header-module--site-header--e2980 a:visited{color:#fff;text-decoration:none}.header-module--site-header--e2980 .header-module--menu--4f3a7{list-style-type:none;margin:0;padding:0}.header-module--site-header--e2980 .header-module--logo--9932e{flex:1 1;font-size:2em;padding:.5em .5em .5em 0}.header-module--site-header--e2980 .header-module--logo--9932e img{height:53px;width:260px}.header-module--site-header--e2980 .header-module--title--de67b{display:none}.header-module--site-header--e2980 .header-module--logo--9932e img{vertical-align:middle}.header-module--site-header--e2980 .header-module--item--19b7b{padding:1em}.header-module--site-header--e2980 .header-module--menu--4f3a7{align-items:center;background:none;display:flex;justify-content:center}.header-module--site-header--e2980 .header-module--menu--4f3a7 li a{display:block;padding:.25em}.header-module--site-header--e2980 .header-module--item--19b7b{display:block;position:relative;text-align:center;width:auto}@media only screen and (min-width:769px){.header-module--site-header--e2980 .header-module--title--de67b{display:inline-block}}.footer-module--site-footer--6a434{background-color:#fff4e9;color:#999;font-family:Poppins,sans-serif;font-size:.85em;margin-top:5em;padding:5em 0;text-align:center}.footer-module--site-footer--6a434 .footer-module--social-icons--8b30e{margin-top:.5em}.footer-module--site-footer--6a434 .footer-module--social-icons--8b30e a{border-bottom:none;color:#999;display:inline-block;font-size:2em;margin:0 .25em;text-decoration:none}article._404-module--content-page--5bdb8 blockquote{border-left:5px solid #ccc;color:#666;font-style:italic;margin-left:0;padding:.5em}article._404-module--content-page--5bdb8 ol,article._404-module--content-page--5bdb8 ul{margin-left:1em}article._404-module--content-page--5bdb8 ul li{list-style-type:square}article._404-module--content-page--5bdb8 ol li,article._404-module--content-page--5bdb8 ul li{margin-bottom:.5em}article._404-module--content-page--5bdb8 a:link,article._404-module--content-page--5bdb8 a:visited{border-bottom:1px solid #231f20;color:#231f20;text-decoration:none}article._404-module--content-page--5bdb8 a:active,article._404-module--content-page--5bdb8 a:hover{border-bottom:1px solid #639;color:#639;text-decoration:none}article._404-module--content-page--5bdb8 footer{border:1px solid #eee;border-radius:7px;font-family:Poppins,sans-serif;font-size:.85em;line-height:1.25em;margin-top:3em;padding:1em}@media only screen and (min-width:769px){article._404-module--content-page--5bdb8{margin:0 auto;max-width:800px;padding:4em 4em 2em}}.pagination-module--pager--f7df7{font-family:Poppins,sans-serif;font-size:.9em;text-align:center}.pagination-module--pager--f7df7 ul{list-style-type:none;margin:0;padding:0}.pagination-module--pager--f7df7 li{display:inline-block;margin:0 .75em 0 0;padding:0}.pagination-module--pager--f7df7 li.pagination-module--item--7cecd a{color:#ff5e1a;text-decoration:none}.pagination-module--pager--f7df7 li.pagination-module--selected--e8dcd a{border:1px solid #ff5e1a;border-radius:4px;color:#ff5e1a;padding:.25em .75em;text-decoration:none}article.content-page-module--content-page--bbab4 blockquote{border-left:5px solid #ccc;color:#666;font-style:italic;margin-left:0;padding:.5em}article.content-page-module--content-page--bbab4 ol,article.content-page-module--content-page--bbab4 ul{margin-left:1em}article.content-page-module--content-page--bbab4 ul li{list-style-type:square}article.content-page-module--content-page--bbab4 ol li,article.content-page-module--content-page--bbab4 ul li{margin-bottom:.5em}article.content-page-module--content-page--bbab4 a:link,article.content-page-module--content-page--bbab4 a:visited{border-bottom:1px solid #231f20;color:#231f20;text-decoration:none}article.content-page-module--content-page--bbab4 a:active,article.content-page-module--content-page--bbab4 a:hover{border-bottom:1px solid #639;color:#639;text-decoration:none}article.content-page-module--content-page--bbab4 footer{border:1px solid #eee;border-radius:7px;font-family:Poppins,sans-serif;font-size:.85em;line-height:1.25em;margin-top:3em;padding:1em}@media only screen and (min-width:769px){article.content-page-module--content-page--bbab4{margin:0 auto;max-width:800px;padding:4em 4em 2em}}.avatar-block-module--avatar-block--32708{align-items:center;display:flex;margin:1em}.avatar-block-module--avatar-block--32708 .avatar-block-module--image--7564f{border-radius:100%;display:block;margin:0 15 0 0;min-width:45}.avatar-block-module--avatar-block--32708 ul{margin:0;padding:0}.avatar-block-module--avatar-block--32708 li{display:block;flex:1 1;margin:0;padding:0}.avatar-block-module--avatar-block--32708 li.avatar-block-module--author--df6f4{color:#000;font-size:.9em;margin:.8em 0 0}.avatar-block-module--avatar-block--32708 li.avatar-block-module--text--2a5a5{color:#999;font-size:.75em;margin-bottom:1em}.share-module--share-links--aeab4{color:#ff5e1a;font-family:Poppins,sans-serif;font-size:.8em;margin-top:1em}.share-module--share-links--aeab4 ul{display:inline-block;list-style-type:none;margin:0 0 0 1em!important;padding:0!important}.share-module--share-links--aeab4 ul li{display:inline-block;margin:0 1em 0 0!important;padding:0!important}.share-module--share-links--aeab4 ul li a:active,.share-module--share-links--aeab4 ul li a:hover,.share-module--share-links--aeab4 ul li a:link,.share-module--share-links--aeab4 ul li a:visited{border-bottom:none;font-size:1.5em;text-decoration:none}.tags-module--tags--a9fcf{color:#ff5e1a;font-family:Poppins,sans-serif;font-size:.8em;margin-top:3em}.tags-module--tags--a9fcf ul{display:inline-block;list-style-type:none;margin:0 0 0 1em!important;padding:0!important}.tags-module--tags--a9fcf ul li{display:inline-block;margin:0 1em 0 0!important;padding:0!important}.tags-module--tags--a9fcf ul li a:link,.tags-module--tags--a9fcf ul li a:visited{border:1px solid #eee;border-radius:4px;padding:.15em .5em!important;text-decoration:none}.tags-module--tags--a9fcf ul li a:active,.tags-module--tags--a9fcf ul li a:hover{background-color:#ff5e1a;border:1px solid #ff5e1a;border-radius:4px;color:#fff;padding:.15em .5em!important;text-decoration:none}article.blog-post-module--blog-post--59946 blockquote{border-left:5px solid #ccc;color:#666;font-style:italic;margin-left:0;padding:.5em}article.blog-post-module--blog-post--59946 ol,article.blog-post-module--blog-post--59946 ul{margin-left:1em}article.blog-post-module--blog-post--59946 ul li{list-style-type:square}article.blog-post-module--blog-post--59946 ol li,article.blog-post-module--blog-post--59946 ul li{margin-bottom:.5em}article.blog-post-module--blog-post--59946 a:link,article.blog-post-module--blog-post--59946 a:visited{color:#ff5e1a;text-decoration:none}article.blog-post-module--blog-post--59946 a:active,article.blog-post-module--blog-post--59946 a:hover{border-bottom:1px solid #ff5e1a;color:#ff5e1a;text-decoration:none}article.blog-post-module--blog-post--59946 footer{border:1px solid #eee;border-radius:7px;font-family:Poppins,sans-serif;font-size:.85em;line-height:1.25em;margin-top:3em;padding:1em}@media only screen and (min-width:769px){article.blog-post-module--blog-post--59946{margin:0 auto;max-width:800px;padding:4em 4em 2em}}.tag-list-module--tag-list--44964{line-height:1.5em;margin:0;padding:2em}.tag-list-module--tag-list--44964 h2{font-family:Poppins,sans-serif;font-size:1.5em;margin:0;text-transform:uppercase}.tag-list-module--tag-list--44964 .tag-list-module--post-count--ff8d3{color:#666;font-family:Poppins,sans-serif;font-size:1em;margin-bottom:3em}.blog-list-module--blog-list--8ca92{margin:2em 0 0;padding:0}.blog-list-module--blog-list--8ca92 h3{color:#ff5e1a;font-family:Poppins,sans-serif;margin:1em}.blog-list-module--blog-list--8ca92 ul{list-style-type:none;margin:0;padding:0}.blog-list-module--cards--0638b{display:flex;flex-wrap:wrap;justify-content:left}.blog-list-module--cards--0638b a:active,.blog-list-module--cards--0638b a:hover,.blog-list-module--cards--0638b a:link,.blog-list-module--cards--0638b a:visited{color:#000;text-decoration:none}.blog-list-module--card--710b0{background-color:#fff;border-radius:5px;box-shadow:0 5px 5px hsla(0,0%,39%,.1);flex:0 1 100%;margin:0 1em 1em;overflow:hidden}.blog-list-module--card--710b0 .blog-list-module--image--aa2ec{margin:1em auto 0;max-width:300px;overflow:hidden}.blog-list-module--card--710b0 .blog-list-module--text--d2b17{padding:0 1em}.blog-list-module--card--710b0 h3{font-family:Poppins,sans-serif;font-size:1.2em;line-height:1.25em;margin:1em 0}.blog-list-module--card--710b0 p{font-family:Poppins,sans-serif;font-size:1em;line-height:1.25em}.blog-list-module--card--710b0 .blog-list-module--cta--6e34c{color:#ff5e1a}@media only screen and (min-width:769px){.blog-list-module--blog-list--8ca92{margin:2em auto 0;max-width:960px;padding:0}.blog-list-module--blog-list--8ca92 h2{margin:1em 0}.blog-list-module--blog-list--8ca92 ul li{margin:0 .5em 1em 0}.blog-list-module--card--710b0{flex:0 1 32%;margin:0 0 1em}.blog-list-module--card--710b0 .blog-list-module--image--aa2ec{margin:0;max-width:none}}</style><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-04DFKSW8B4"></script><script>
      
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-04DFKSW8B4',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-04DFKSW8B4', {"anonymize_ip":true,"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap.xml/sitemap-index.xml"/><title data-react-helmet="true">Kafka Integration Testing with Testcontainers</title><link data-react-helmet="true" rel="canonical" href="https://testingboss.com /blog/kafka-integration-testing/"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link href="https://fonts.googleapis.com/css?family=Poppins:300&amp;display=swap" rel="stylesheet"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><header class="header-module--site-header--e2980"><nav><ul class="header-module--menu--4f3a7"><li class="header-module--logo--9932e"><a href="/"><img src="/static/logo-fac8601989adce0de0d7609e61355283.png" alt="Testing Boss" title="Testing Boss"/></a></li><li class="header-module--item--19b7b"><a href="/about"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="circle-question" class="svg-inline--fa fa-circle-question " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 512c141.4 0 256-114.6 256-256S397.4 0 256 0S0 114.6 0 256S114.6 512 256 512zM169.8 165.3c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24V250.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1H222.6c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM288 352c0 17.7-14.3 32-32 32s-32-14.3-32-32s14.3-32 32-32s32 14.3 32 32z"></path></svg></a></li></ul></nav></header><main><article class="blog-post-module--blog-post--59946" itemscope="" itemType="http://schema.org/Article"><header><h1 itemProp="headline">Kafka Integration Testing with Testcontainers</h1><div class="avatar-block-module--avatar-block--32708"><div data-gatsby-image-wrapper="" style="width:45px;height:45px" class="gatsby-image-wrapper avatar-block-module--image--7564f"><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#e8e8e8;width:45px;height:45px;position:relative"></div><picture><source type="image/webp" data-srcset="/static/a84f9189f0c7118e58455d2edbf1bd59/29677/profile-pic.webp 45w,/static/a84f9189f0c7118e58455d2edbf1bd59/5d191/profile-pic.webp 90w" sizes="45px"/><img data-gatsby-image-ssr="" data-main-image="" style="border-radius:50%;opacity:0" sizes="45px" decoding="async" loading="lazy" data-src="/static/a84f9189f0c7118e58455d2edbf1bd59/b7413/profile-pic.jpg" data-srcset="/static/a84f9189f0c7118e58455d2edbf1bd59/b7413/profile-pic.jpg 45w,/static/a84f9189f0c7118e58455d2edbf1bd59/a9a36/profile-pic.jpg 90w" alt="Kwo Ding"/></picture><noscript><picture><source type="image/webp" srcSet="/static/a84f9189f0c7118e58455d2edbf1bd59/29677/profile-pic.webp 45w,/static/a84f9189f0c7118e58455d2edbf1bd59/5d191/profile-pic.webp 90w" sizes="45px"/><img data-gatsby-image-ssr="" data-main-image="" style="border-radius:50%;opacity:0" sizes="45px" decoding="async" loading="lazy" src="/static/a84f9189f0c7118e58455d2edbf1bd59/b7413/profile-pic.jpg" srcSet="/static/a84f9189f0c7118e58455d2edbf1bd59/b7413/profile-pic.jpg 45w,/static/a84f9189f0c7118e58455d2edbf1bd59/a9a36/profile-pic.jpg 90w" alt="Kwo Ding"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><ul><li class="avatar-block-module--author--df6f4">Kwo Ding</li><li class="avatar-block-module--text--2a5a5">1 Mar 2023</li></ul></div></header><section itemProp="articleBody"><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 49.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAADBP/aAAwDAQACEAMQAAABxnNp1zhAaf/EABsQAAIBBQAAAAAAAAAAAAAAAAABAhAREiEx/9oACAEBAAEFAlG5qBkzkHT/xAAWEQEBAQAAAAAAAAAAAAAAAAABECL/2gAIAQMBAT8BNM//xAAWEQEBAQAAAAAAAAAAAAAAAAAAETH/2gAIAQIBAT8BxX//xAAXEAADAQAAAAAAAAAAAAAAAAAAICFh/9oACAEBAAY/Aoav/8QAGRABAAMBAQAAAAAAAAAAAAAAAQARITEQ/9oACAEBAAE/IW5Rpo2FG1jjWZO/P//aAAwDAQACAAMAAAAQxD//xAAYEQEAAwEAAAAAAAAAAAAAAAABABExUf/aAAgBAwEBPxBNThKOT//EABYRAQEBAAAAAAAAAAAAAAAAAAERAP/aAAgBAgEBPxBJpq3/xAAbEAEAAgIDAAAAAAAAAAAAAAABACEQETFRcf/aAAgBAQABPxBax7jGBpuozQrPanFSyXH/2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Data streams"
        title=""
        src="/static/f0319c86b2f76e33de4adb79f3866b19/4b190/data-streams.jpg"
        srcset="/static/f0319c86b2f76e33de4adb79f3866b19/e07e9/data-streams.jpg 200w,
/static/f0319c86b2f76e33de4adb79f3866b19/066f9/data-streams.jpg 400w,
/static/f0319c86b2f76e33de4adb79f3866b19/4b190/data-streams.jpg 800w,
/static/f0319c86b2f76e33de4adb79f3866b19/e5166/data-streams.jpg 1200w,
/static/f0319c86b2f76e33de4adb79f3866b19/b17f8/data-streams.jpg 1600w,
/static/f0319c86b2f76e33de4adb79f3866b19/a94c4/data-streams.jpg 4069w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<p>Communication with a message broker is a common practice, used for a variety of reasons, to decouple processing from data producers, to buffer unprocessed messages, etc. One of the most popular message brokers used at the moment is <a href="https://kafka.apache.org/">Kafka</a>. Kafka can also be used for other use cases, other than messaging, such as website activity tracking, metrics and log aggregation. In this article I will focus on integration testing with Kafka as a message broker.</p>
<p>Let’s take a typical movie catalog service as an example which produces messages to and consumes messages from Kafka topics.</p>
<ul>
<li>Producing messages: when a movie is added to the catalog, it also sends a status update to a Kafka topic for other systems to consume.</li>
<li>Consuming messages: the service consumes from a Kafka topic to get updates on comments</li>
</ul>
<p>How do integration tests look like to cover both message flows? Integration testing can be done on different levels. Here I will cover testing the service under test as close to production as possible, but without relying on other services, (shared) environments and external dependencies.</p>
<p>We need a couple of things to achieve this:</p>
<ul>
<li>The Kafka message broker</li>
<li>A <code class="language-text">KafkaConsumer</code> that can consume the Kafka message that the service is sending.</li>
<li>A <code class="language-text">KafkaProducer</code> that can produce a Kafka message to the topic that the service is subscribed to.</li>
<li>The actual test that triggers functionality on the service which then triggers the Kafka message.</li>
<li>Another test that produces the Kafka message for the service to consume.</li>
</ul>
<h2>Kafka with Testcontainers</h2>
<p>With <a href="https://www.testcontainers.org/">Testcontainers</a> it is very easy to programmatically boot up a Docker container without much configuration. In this way the service under test can communicate with the Kafka broker by just configuring the correct url in the service configuration. The simplest example to spin up a Kafka container looks like this:</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token class-name">KafkaContainer</span> kafka <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaContainer</span><span class="token punctuation">(</span><span class="token class-name">DockerImageName</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"confluentinc/cp-kafka"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Yes, that’s it. There are obviously more configuration options available (check out the docs), but for this test example, let’s use this default setup.</p>
<h2>KafkaConsumer</h2>
<p>Here is a simple example of a <code class="language-text">KafkaConsumer</code> used for testing. For demonstration purposes we will use <code class="language-text">String</code> serialization. In practice, specific data serializers are usually used, such as <a href="https://avro.apache.org/">Avro</a>. To test the service under test in isolation, this <code class="language-text">KafkaTestConsumer</code> will simulate the behavior of an actual consumer of the Kafka topic.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KafkaTestConsumer</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">KafkaConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> consumer<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">KafkaTestConsumer</span><span class="token punctuation">(</span><span class="token class-name">String</span> bootstrapServers<span class="token punctuation">,</span> <span class="token class-name">String</span> groupId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Properties</span> props <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">BOOTSTRAP_SERVERS_CONFIG</span><span class="token punctuation">,</span> bootstrapServers<span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">GROUP_ID_CONFIG</span><span class="token punctuation">,</span> groupId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">KEY_DESERIALIZER_CLASS_CONFIG</span><span class="token punctuation">,</span> <span class="token class-name">StringDeserializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">VALUE_DESERIALIZER_CLASS_CONFIG</span><span class="token punctuation">,</span> <span class="token class-name">StringDeserializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">AUTO_OFFSET_RESET_CONFIG</span><span class="token punctuation">,</span> <span class="token string">"earliest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>consumer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> topics<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        consumer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>topics<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">ConsumerRecords</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> consumer<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre></div>
<h2>Testing the production of messages</h2>
<p>First, the test where we consume the message which the service is sending. Here we subscribe to the topic from the <code class="language-text">KafkaTestConsumer</code>. When we invoke the functionality on the service under test, it will trigger sending the Kafka message. The <code class="language-text">KafkaTestConsumer</code> consumes the topic and finally we can check on the message coming in.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">KafkaContainer</span> kafka <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaContainer</span><span class="token punctuation">(</span><span class="token class-name">DockerImageName</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"confluentinc/cp-kafka"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@BeforeEach</span>
<span class="token keyword">void</span> <span class="token function">startContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    kafka<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">shouldSendStatusUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">KafkaTestConsumer</span> kafkaTestConsumer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaTestConsumer</span><span class="token punctuation">(</span>kafka<span class="token punctuation">.</span><span class="token function">getBootstrapServers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"test_group"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    kafkaTestConsumer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token function">singletonList</span><span class="token punctuation">(</span><span class="token string">"catalog_topic"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> movieId <span class="token operator">=</span> service<span class="token punctuation">.</span><span class="token function">addMovieToCatalog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">ConsumerRecords</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> records <span class="token operator">=</span> kafkaTestConsumer<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">assertThat</span><span class="token punctuation">(</span>records<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// As mentioned before, in this example we are using String serializers, in practice it is very common to use Avro schemas to serialize these messages</span>
    records<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEachRemaining</span><span class="token punctuation">(</span>record <span class="token operator">-></span> <span class="token function">assertThat</span><span class="token punctuation">(</span>mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">MovieState</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span><span class="token class-name">MovieState</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">movieId</span><span class="token punctuation">(</span>movieId<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token string">"CREATED"</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h3>KafkaProducer</h3>
<p>Very similar to the <code class="language-text">KafkaConsumer</code> above, here is an example of a <code class="language-text">KafkaProducer</code> used for testing which we need to simulate the behavior of an actual producer.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KafkaTestProducer</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">KafkaProducer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> producer<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">KafkaTestProducer</span><span class="token punctuation">(</span><span class="token class-name">String</span> bootstrapServers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Properties</span> props <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">ACKS_CONFIG</span><span class="token punctuation">,</span> <span class="token string">"all"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">RETRIES_CONFIG</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">BOOTSTRAP_SERVERS_CONFIG</span><span class="token punctuation">,</span> bootstrapServers<span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">KEY_SERIALIZER_CLASS_CONFIG</span><span class="token punctuation">,</span> <span class="token class-name">StringSerializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">VALUE_SERIALIZER_CLASS_CONFIG</span><span class="token punctuation">,</span> <span class="token class-name">StringSerializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>producer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaProducer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">String</span> topicName<span class="token punctuation">,</span> <span class="token class-name">Object</span> messageObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        producer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ProducerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>topicName<span class="token punctuation">,</span> mapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>messageObject<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre></div>
<h2>Testing the consumption of messages</h2>
<p>For this test on producing a Kafka message for the service to consume, we use the <code class="language-text">KafkaTestProducer</code> to send a message. After sending, we check the processed result on the service under test.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">shouldProcessComments</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">KafkaTestProducer</span> kafkaTestProducer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaTestProducer</span><span class="token punctuation">(</span>kafka<span class="token punctuation">.</span><span class="token function">getBootstrapServers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> movieId <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">assertThat</span><span class="token punctuation">(</span>service<span class="token punctuation">.</span><span class="token function">getComments</span><span class="token punctuation">(</span>movieId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    kafkaTestProducer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"comments_topic"</span><span class="token punctuation">,</span> <span class="token class-name">MovieComment</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">movieId</span><span class="token punctuation">(</span>movieId<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">commentId</span><span class="token punctuation">(</span><span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token string">"SUBMITTED"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">assertThat</span><span class="token punctuation">(</span>service<span class="token punctuation">.</span><span class="token function">getComments</span><span class="token punctuation">(</span>movieId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasSize</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>You might wonder how to deal with certain delays in the tests. It may take a few seconds before the comments have been updated on the service side.</p>
<p>With <a href="http://www.awaitility.org/">Awaitility</a> handling asynchronous behavior is a breeze, for example:</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token function">await</span><span class="token punctuation">(</span><span class="token string">"Polling until comments are received"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pollInterval</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token constant">SECONDS</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">atMost</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token constant">SECONDS</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token operator">!</span>service<span class="token punctuation">.</span><span class="token function">getComments</span><span class="token punctuation">(</span>movieId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Here you only need to define the polling times and the condition on which it waits until it is <code class="language-text">true</code>. In case it never evaluates to <code class="language-text">true</code>, it will timeout based on the max timeout specified.</p>
<h2>Conclusion</h2>
<p>Testing Kafka messages is made easy with <a href="https://www.testcontainers.org/">Testcontainers</a>. The <a href="https://kafka.apache.org/">Kafka</a> Docker container is spun up on-the-fly via Testcontainers. Simulating the behavior of other systems can be simply done by creating a <code class="language-text">KafkaProducer</code> or <code class="language-text">KafkaConsumer</code> as part of your test. In this way your service can be completely tested without relying on any other environment or dependencies. Be aware that this type of messaging is asynchronous. To handle this in an easy way from a testing point of view, you can use <a href="http://www.awaitility.org/">Awaitility</a> instead of implementing your own polling mechanism.</p></section><nav class="tags-module--tags--a9fcf">Tags:<ul><li><a itemProp="url" href="/tag/automation/">automation</a></li><li><a itemProp="url" href="/tag/testcontainers/">testcontainers</a></li><li><a itemProp="url" href="/tag/kafka/">kafka</a></li><li><a itemProp="url" href="/tag/integration/">integration</a></li><li><a itemProp="url" href="/tag/async/">async</a></li><li><a itemProp="url" href="/tag/docker/">docker</a></li><li><a itemProp="url" href="/tag/container/">container</a></li></ul></nav><div class="share-module--share-links--aeab4">Share:<ul><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Ftestingboss.com%2Fblog%2Fkafka-integration-testing%2F" target="_blank" rel="noreferrer" aria-label="Share on Twitter"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" class="svg-inline--fa fa-twitter " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a></li><li><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftestingboss.com%2Fblog%2Fkafka-integration-testing%2F" target="_blank" rel="noreferrer" aria-label="Share on LinkedIn"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></li></ul></div></article></main><footer class="footer-module--site-footer--6a434">©<!-- --> <!-- -->2023<!-- --> <!-- -->Testing Boss<!-- -->. All rights reserved.<div class="footer-module--social-icons--8b30e"><a href="https://twitter.com/@kwo_ding" target="_blank" rel="noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" class="svg-inline--fa fa-twitter " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><a href="https://linkedin.com/in/kwoding" target="_blank" rel="noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a><a href="https://github.com/kwoding" target="_blank" rel="noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/kafka-integration-testing/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-2ab1df68c75591a2e2b4.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-954503a7a235350ecec6.js\"],\"component---src-templates-blog-list-page-tsx\":[\"/component---src-templates-blog-list-page-tsx-a94dbdb8ea3ea2642d6c.js\"],\"component---src-templates-blog-post-tsx\":[\"/component---src-templates-blog-post-tsx-97845620a1c4b2945fcb.js\"],\"component---src-templates-content-page-tsx\":[\"/component---src-templates-content-page-tsx-d2f9ded0c6337b1a4fba.js\"],\"component---src-templates-tag-list-tsx\":[\"/component---src-templates-tag-list-tsx-15b3e0f45930abe40dbf.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="37d8dde2883d660941d9";</script><script src="/webpack-runtime-4083c692cdb83f55614a.js" async></script><script src="/framework-84b8c890c73be869aeef.js" async></script><script src="/app-2ab1df68c75591a2e2b4.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>