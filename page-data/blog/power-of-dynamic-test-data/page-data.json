{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/power-of-dynamic-test-data/","result":{"data":{"site":{"siteMetadata":{"title":"Testing Boss","siteUrl":"https://testingboss.com"}},"markdownRemark":{"id":"fd5c006c-0c7c-515b-92e4-db56fc41eeb7","fields":{"slug":"/power-of-dynamic-test-data/"},"excerpt":"In my experience I have seen many tests that run on every commit. Often these unit/integration tests use fixed data, so that the tests are reproducable and…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFA//EABUBAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAGotMwHyWVH/8QAGhAAAgIDAAAAAAAAAAAAAAAAAQIAAwQRI//aAAgBAQABBQLfJ7mCnKiWEIbWhef/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPwFX/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAHRAAAQIHAAAAAAAAAAAAAAAAAAERAhAxMpGhov/aAAgBAQAGPwJIh35LtCSomD//xAAdEAEAAgEFAQAAAAAAAAAAAAABABEhMUFRYXHR/9oACAEBAAE/IatysCexPr7DSLfwj8546mVSkRYv/9oADAMBAAIAAwAAABALH//EABYRAQEBAAAAAAAAAAAAAAAAAAERAP/aAAgBAwEBPxAgV1b/xAAWEQEBAQAAAAAAAAAAAAAAAAAAEXH/2gAIAQIBAT8QxH//xAAcEAEBAAEFAQAAAAAAAAAAAAABEQAhMUFRcWH/2gAIAQEAAT8QTQJQlo4nPmTcAWQvTXTF1FTUvH3FgsEStHzrLVc3rbjdQ8Gf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Network\"\n        title=\"\"\n        src=\"/static/2878361a6dba26b0fa43b0b048f42cd4/4b190/test-data.jpg\"\n        srcset=\"/static/2878361a6dba26b0fa43b0b048f42cd4/e07e9/test-data.jpg 200w,\n/static/2878361a6dba26b0fa43b0b048f42cd4/066f9/test-data.jpg 400w,\n/static/2878361a6dba26b0fa43b0b048f42cd4/4b190/test-data.jpg 800w,\n/static/2878361a6dba26b0fa43b0b048f42cd4/e5166/test-data.jpg 1200w,\n/static/2878361a6dba26b0fa43b0b048f42cd4/b17f8/test-data.jpg 1600w,\n/static/2878361a6dba26b0fa43b0b048f42cd4/bc6ca/test-data.jpg 4076w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>In my experience I have seen many tests that run on every commit. Often these unit/integration tests use fixed data, so that the tests are reproducable and stable. That is a good thing, right? Well, not always.</p>\n<p>So the great thing about automated tests is that you can run many tests in a very short time. Additionally, you can also run tests with different parameters with a breeze. I have seen many tests running thousand times a day and they always pass, especially due to the fixed data. What if you could catch certain unexpected cases by just using random valid data? This would add more value to an automated test over time.</p>\n<h2>A real world example</h2>\n<p>Let’s say we have a Spring Boot application that can perform payments by IBAN number. We enable this payment feature per country for this application by configuration, so that we can easily control this without changing any application code.</p>\n<p>Example of the configuration in the <code class=\"language-text\">application.yaml</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">countries.enabled</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> AT\n  <span class=\"token punctuation\">-</span> BE\n  <span class=\"token punctuation\">-</span> BR\n  <span class=\"token punctuation\">-</span> CZ\n  <span class=\"token punctuation\">-</span> DK\n  <span class=\"token punctuation\">-</span> DE\n  <span class=\"token punctuation\">-</span> NL</code></pre></div>\n<p>In the application we have the check to make sure that the IBAN number that is used is from one of these countries.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"countries.enabled\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> enabledCountryCodes<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isIbanInEnabledCountry</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> ibanNumber<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">String</span> countryCode <span class=\"token operator\">=</span> ibanNumber<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> enabledCountryCodes<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span>countryCode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>So far so good, right? Well, you can argue about this design, but nevertheless, this is a real world example I have seen in practice.</p>\n<p>A test could be as easy as this:</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">ibanInEnabledCountry</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span><span class=\"token function\">isIbanInEnabledCountry</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"NL69RABO1319778291\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isTrue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now, we are expanding the feature with a couple more countries:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">countries.enabled</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> AT\n  <span class=\"token punctuation\">-</span> BE\n  <span class=\"token punctuation\">-</span> BR\n  <span class=\"token punctuation\">-</span> CZ\n  <span class=\"token punctuation\">-</span> DK\n  <span class=\"token punctuation\">-</span> DE\n  <span class=\"token punctuation\">-</span> IE\n  <span class=\"token punctuation\">-</span> IT\n  <span class=\"token punctuation\">-</span> NL\n  <span class=\"token punctuation\">-</span> NO\n  <span class=\"token punctuation\">-</span> PT</code></pre></div>\n<p>In this case the test still passes, no worries. Testing every single country is just overkill. The mechanism is quite straightforward, right? Well, if you would test with a Norwegian IBAN number the test would fail:</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">ibanInEnabledCountry</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span><span class=\"token function\">isIbanInEnabledCountry</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"NO9386011117947\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isTrue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Why? Maybe the YAML gurus reading this, already know the problem. Let me explain. The value <code class=\"language-text\">NO</code> in the YAML file evaluates to <code class=\"language-text\">false</code>. This means that the String list <code class=\"language-text\">enabledCountryCodes</code> contains the value <code class=\"language-text\">false</code> instead of <code class=\"language-text\">NO</code>. It is easy to fix by putting the <code class=\"language-text\">NO</code> between quotes of course.</p>\n<p>Back to the test, how could we utilize the power of dynamic test data in this automated test to catch this somewhat unexpected case? Like I said, it is an overkill to test each single country every time. Imagine having a list of a hundred countries.</p>\n<p>Use <a href=\"https://github.com/DiUS/java-faker\">javafaker</a> or <a href=\"https://github.com/datafaker-net/datafaker\">datafaker</a> to generate a random valid IBAN number for the list of countries. These libraries are great to generate random valid data, such as names, addresses, URLs, e-mail addresses.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Faker</span> faker <span class=\"token operator\">=</span> <span class=\"token class-name\">Faker</span><span class=\"token punctuation\">.</span><span class=\"token function\">newInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Random</span> random <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">ibanInEnabledCountry</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">String</span> iban <span class=\"token operator\">=</span> faker<span class=\"token punctuation\">.</span>finance<span class=\"token punctuation\">.</span><span class=\"token function\">iban</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">String</span> enabledCountryCode <span class=\"token operator\">=</span> enabledCountryCodes<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>random<span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span>enabledCountryCodes<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token class-name\">String</span> enabledIban <span class=\"token operator\">=</span> enabledCountryCode <span class=\"token operator\">+</span> iban<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span><span class=\"token function\">isIbanInEnabledCountry</span><span class=\"token punctuation\">(</span>enabledIban<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isTrue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This way this bug was actually caught in practice.</p>\n<h2>Conclusion</h2>\n<p>Automated tests are great and when using fixed test data over and over again, the test is obviously reproducable and consistent. However, if you use random valid data as part of the test, the test increases in value and is still valid. This is because using valid random data could catch unexpected behavior.</p>","frontmatter":{"title":"The Power of Dynamic Test Data","date":"5 Feb 2023","description":"Use random valid test data to increase test coverage.","tags":["automation","data","coverage"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/2878361a6dba26b0fa43b0b048f42cd4/26cfb/test-data.jpg","srcSet":"/static/2878361a6dba26b0fa43b0b048f42cd4/26cfb/test-data.jpg 500w,\n/static/2878361a6dba26b0fa43b0b048f42cd4/b3b6f/test-data.jpg 1000w","sizes":"500px"},"sources":[{"srcSet":"/static/2878361a6dba26b0fa43b0b048f42cd4/921bf/test-data.webp 500w,\n/static/2878361a6dba26b0fa43b0b048f42cd4/993a1/test-data.webp 1000w","type":"image/webp","sizes":"500px"}]},"width":500,"height":333}}}}}},"pageContext":{"slug":"/power-of-dynamic-test-data/"}},"staticQueryHashes":["1052764262","2841359383","3159585216","3849765996"],"slicesMap":{}}